{{ define "pre-main" }}
{{ partial "landingpage/banner.html" . }}
{{ end }}

{{ define "main" }}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
  rel="stylesheet" />

{{ partial "landingpage/about.html" .}}

{{ partial "overview_block.html" .}}

<style>
  .algolia-search {
    .search-panel {
      display: flex;
    }

    .search-panel__results {
      flex: 3;
    }

    .ais-Highlight-highlighted {
      color: inherit;
      font-size: inherit;
    }

    #searchbox {
      margin-bottom: 2rem;
    }

    #pagination {
      margin: 2rem auto;
      text-align: center;
    }

    .search-result-row {
      @media (min-width: 992px) {
        height: 220px;
      }
    }

    .ais-Hits-item {
      padding: 0;
      margin-top: 10px;
      margin-bottom: 10px;
    }

    .search-result-image {
      height: auto;
      max-height: 175px;
      max-width: 100%;
      margin: auto;
    }

    .search-result-title {
      margin-top: 40px;
    }

    ol.ais-Hits-list {
      list-style: none;
    }

    .ais-Highlight-highlighted,
    .ais-Snippet-highlighted {
      background-color: #FFFF92;
    }
  }
</style>
<!-- Search -->
<section class="section color-blue">
  <div class="container algolia-search rounded-lg bg-lightblue">
    <div class="row">
      <div class="col">
        <h2 class="pt-5 color-blue">Search</h2>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="search-panel">
          <div class="search-panel__results d-block">
            <div id="searchbox"></div>
            <div id="hits"></div>
            <div id="pagination"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.10.5/dist/algoliasearch-lite.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.79.0"></script>
<script>
  const { algoliasearch, instantsearch } = window;

  const searchClient = algoliasearch(
    'R5LXP5NUID',
    '4b504b6988d05a7631d6a330fb7afa58'
  );

  const search = instantsearch({
    indexName: 'website_pages',
    searchClient,
    future: { preserveSharedStateOnUnmount: true },
  });

  let lastRenderArgs;

  const infiniteHits = instantsearch.connectors.connectInfiniteHits(
    (renderArgs, isFirstRender) => {
      const { items, showMore, widgetParams } = renderArgs;
      const { container } = widgetParams;

      lastRenderArgs = renderArgs;

      if (isFirstRender) {
        const sentinel = document.createElement('div');
        container.appendChild(document.createElement('ul'));
        container.appendChild(sentinel);

        const observer = new IntersectionObserver(entries => {
          entries.forEach(entry => {
            if (entry.isIntersecting && !lastRenderArgs.isLastPage) {
              showMore();
            }
          });
        });

        observer.observe(sentinel);

        return;
      }

      container.querySelector('ul').innerHTML = items
        .map(
          item => {
            return `
            <a href=${item.url} class="container">
              <div class="row search-result-row bg-white">
                <div class="col-12 col-lg-2">
                  <div class="my-3">
                    <img class="image-fluid search-result-image d-flex" src=${item.image} alt=${item.title} />
                  </div>
                </div>
                <div class="col-12 col-lg-10">
                  <h3 class="color-blue search-result-title">${item.title}</h3>
                  <p class="color-gray search-result-subtitle">${item.subtitle}</p>
                </div>
              </div>
            </a>
          `;
          })
        .join('');
    }
  );
  search.addWidgets([
    instantsearch.widgets.searchBox({
      container: '#searchbox',
    }),
    instantsearch.widgets.configure({
      hitsPerPage: 8,
      filters: "language:{{$.Site.Language.Lang}}"
    }),
    infiniteHits({
      container: document.querySelector('#hits'),
    }),
  ]);


  search.start();
</script>
<!-- /Search -->

{{ partial "landingpage/activityfeed.html" . }}

<!-- Areas of expertise -->
{{ with .Params.Areas_of_AI_expertise }}
{{ if .enable }}
<section class="section color-blue">
  <div class="container bg-white">

    <!-- Title -->
    <div class="row">
      <div class="col-12">
        <h3 class="section-title color-blue">{{ .title | markdownify }}</h3>
      </div>
    </div>
    <!-- /Title -->

    <!-- areas of AI expertise -->

    <!-- desktop version -->
    <div class="row justify-content-center desktop mx-3">
      {{$width_m := 4}}
      {{$width_s := 2}}
      {{if .width_m}}
      {{$width_m = .width_m}}
      {{end}}
      {{if .width_s}}
      {{$width_s = .width_s}}
      {{end}}
      {{ range $index, $item := .feature_item }}
      <div class="col-md-{{$width_m}} col-sm-{{$width_s}} mb-4 {{if eq $index 0}}{{else}}border-left-blue{{end}}">
        <div class="feature-card-transparant">
          <i class="{{$item.icon}} mb-3" style="font-size:22px;">
            <h4 class="color-blue d-inline-block" style="padding-left:10px; font-weight:100;">
              {{ $item.name | markdownify }}
            </h4>
          </i>
          <p class="color-blue">{{ $item.content | markdownify }}</p>
        </div>
      </div>
      {{ end }}
    </div>
    <!-- /desktop version -->

    <!-- mobile version -->
    <div class="row justify-content-center mobile">
      {{ range .feature_item }}
      <div class="col-12 m-4 border-top-blue">
        <div class="feature-card-transparant">
          <i class="{{.icon}} mb-3" style="font-size:22px;">
            <h4 class="color-blue d-inline-block" style="padding-left:10px; font-weight:100;">
              {{ .name | markdownify }}
            </h4>
          </i>
          <p class="color-blue">{{ .content | markdownify }}</p>
        </div>
      </div>
      {{ end }}
    </div>
    <!-- /mobile version -->

    <!-- /areas of AI expertise -->

    <!-- Button -->
    <div class="row text-center">
      <div class="col-12" style="margin-top:25px;">
        <a class="btn-link" href="{{.button_link | relURL}}">
          <h3 class="btn color-white">{{.button_text}}</h3>
        </a>
      </div>
    </div>
    <!-- /Button -->
  </div>
</section>
{{end}}
{{end}}
<!-- /Areas of expertise -->

<!-- Distinctive in -->
{{ with .Params.Distinctive_in }}
{{ if .enable }}
<section class="section color-blue">
  <div class="container bg-lightblue py-5">

    <!-- Title -->
    <div class="row">
      <div class="col-12">
        <h3 class="section-title color-blue ml-4">{{ .title | markdownify }}</h3>
      </div>
    </div>
    <!-- /Title -->


    <!-- desktop version -->
    <div class="row justify-content-center desktop mx-3">
      {{$width_m := 4}}
      {{$width_s := 2}}
      {{if .width_m}}
      {{$width_m = .width_m}}
      {{end}}
      {{if .width_s}}
      {{$width_s = .width_s}}
      {{end}}
      {{ range $index, $item := .feature_item }}
      <div class="col-md-{{$width_m}} col-sm-{{$width_s}} mb-4 {{if eq $index 0}}{{else}}border-left-blue{{end}}">
        <div class="feature-card-transparant">
          <i class="{{$item.icon}} mb-3" style="font-size:22px;">
            <h4 class="color-blue d-inline-block" style="padding-left:10px; font-weight:100;">
              {{ $item.name | markdownify }}
            </h4>
          </i>
          <p class="color-blue">{{ $item.content | markdownify }}</p>
        </div>
      </div>
      {{ end }}
    </div>
    <!-- /desktop version -->

    <!-- mobile version -->
    <div class="row justify-content-center mobile">
      {{ range .feature_item }}
      <div class="col-12 m-4 border-top-blue">
        <div class="feature-card-transparant">
          <i class="{{.icon}} mb-3" style="font-size:22px;">
            <h4 class="color-blue d-inline-block" style="padding-left:10px; font-weight:100;">
              {{ .name | markdownify }}
            </h4>
          </i>
          <p class="color-blue">{{ .content | markdownify }}</p>
        </div>
      </div>
      {{ end }}
    </div>
    <!-- /mobile version -->


    <!-- Button -->
    <div class="row text-center">
      <div class="col-12" style="margin-top:25px;">
        <a class="btn-link" href="{{.button_link | relURL}}">
          <h3 class="btn color-white">{{.button_text}}</h3>
        </a>
      </div>
    </div>
    <!-- /Button -->
  </div>
</section>
{{end}}
{{end}}
<!-- /Distinctive in -->



{{ partial "landingpage/supportedby.html" . }}

<!-- Video -->
{{ with .Params.Title_video }}
<section class="section-none bg-white" id="movie-div">
  <div class="container">

    <!-- Title -->
    <div class="row">
      <div class="col-12">
        <h3 class="section-title" style="color: #005aa7;">{{ .title | markdownify }}</h3>
      </div>
    </div>
    <!-- /Title -->

    <div class="row" style="margin-bottom:75px; display: flex; justify-content: center; align-items: center;">
      <video width="100%" height="auto" autoplay muted controls>
        {{ if .video_mp4 }}
        <source src="{{.video_mp4}}" type="video/mp4">
        {{ end }}
        {{ if .video_ogg }}
        <source src="{{.video_ogg}}" type="video/ogg">
        {{ end }}
        Your browser does not support the video tag.
      </video>
    </div>

  </div>
</section>
{{ end }}
<!-- /Video -->

{{ end }}